---
name: "osxcross"
suites:
- "trusty"
architectures:
- "amd64"
packages:
- "clang"
- "llvm-dev"
- "libxml2-dev"
- "uuid-dev"
- "libssl-dev"
- "bsdmainutils"
- "zip"
- "cmake"
reference_datetime: "2013-06-01 00:00:00"
remotes:
- "url": "https://github.com/tpoechtrager/osxcross.git"
  "dir": "osxcross"
- "url": "https://github.com/planetbeing/libdmg-hfsplus"
  "dir": "libdmg-hfsplus"
files:
- "MacOSX10.9.sdk.tar.xz"
script: |
  # Defines
  export TZ=UTC
  export TAR_OPTIONS="-m --mtime="$REFERENCE_DATE\\\ $REFERENCE_TIME""
  BUILDDIR=$HOME/build
  PREFIX=$HOME/install
  mkdir -p $BUILDDIR $PREFIX
  cd $BUILDDIR
  PATH=$PATH:$BUILDDIR

  # Build OSX Cross
  cd osxcross
  ln -s $HOME/build/MacOSX10.9.sdk.tar.xz tarballs/
  UNATTENDED=1 ./build.sh
  cd target
  mv * $PREFIX
  # Fix broken symlinks
  rm -f $PREFIX/bin/osxcross-macports $PREFIX/bin/osxcross-mp $PREFIX/bin/omp
  mv ../tools/osxcross-macports $PREFIX/bin
  cd $PREF